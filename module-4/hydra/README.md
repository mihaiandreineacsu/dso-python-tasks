# My `hydra clone` tool

This folder contains the source code for my own implementation of the `hydra` tool.
Hydra clone can be used to connect to servers via ssh using a list of words as passwords.

This is a lightweight implementation that covers the following features/options:

- Connects to a server via ssh-client using a list of words as the password.
- The list of words can be generated by passing a basic character set or a file containing passwords

## Tabel of content

- [Technologies](#technologies)
- [Dependencies](#dependencies)
- [Command-line arguments](#command-line-arguments)
- [Structure](#structure)
- [Getting started](#getting-started)
- [Installation](#installation)
- [Usage examples](#usage-examples)
- [Prove of concept](#prove-of-concept)

## Technologies

- Windows 11
- Python 3.10.11 (tags/v3.10.11:7d4cc5a, Apr  5 2023, 00:38:17) [MSC v.1929 64 bit (AMD64)] on win32
- venv (python virtual environment)
- Docker (optionally for prove of concept)

## Dependencies

- exrex==0.11.0: used to generate all possible combinations of words from give characterset command-line argument
- paramiko==3.4.0: used for connecting to a server as a user using ssh-client

## Command-line arguments

| Name | Shortname | Description | Default | Type | Mandatory |
| :--- | :--- | :--- | :---: | :---: | :---: |
| `--username` | `-u` | Username to connect | | str | x |
| `--server` | `-s` | Server as IP-Address or DNS name to connect | | str | x |
| `--port` | `-p` | SSH Port | 22 | int | |
| `--wordlist` | `-w` | Word list file used as dictionary | | str | |
| `--characterset` | `-c` | Basic characters set used to generate a list of words | [a-z] | str | |
| `--min` | | Minimal generated word length. Can not be bigger then `--max` | 3 | int | |
| `--max` | | Maximal generated word length. Can not be less then `--min` | 3 | int | |

## Structure

- [hydra.py](./hydra.py): Main file to run and pass command-line arguments
- [ini.py](./init.py): initializes the command-line arguments
- [utils.py](./utils.py): validates min and max command-line arguments, sanitizes complex characterset command-line argument, generates words from characterset command-line argument and reads words from wordlist command-line arguments
- [requirements.txt](./requirements.txt): contains dependencies
- [Dockerfile](./Dockerfile): used as a simple target machine to try ssh connection on, takes two build arguments, PORT for ssh service and PASSWORD for the root user
- [dictionary.txt](./dictionary.txt): used in the [Prove of concept](#prove-of-concept) example

## Getting started

### Installation

```powershell
# Create and activate python virtual environment
python -m venv venv
venv/Scripts/activate

# Activate python environment
./venv/Scripts/activate

# Install dependencies
pip install -r requirements.txt
```

### Usage examples

```powershell
# Start hydra using defaults
python hydra.py \
    -u <username> \     # username: root
    -s <remoteserver> \ # server: 123.45.67.89
```

This generates a list of words, containing all possible combination of all lowercase letters, from a to z with a minimal and maximal length of 3, for each combination.

```powershell
# Start hydra using a characterset with a minimal and maximal word length
python hydra.py \
    -u <username> \     # username: root
    -s <remoteserver> \ # server: 123.45.67.89
    -c [a-z0-9] \       # characterset: [a-zA-Z]
    --min 5 \           # min > 0
    --max 5             # max >= min
```

This generates a list of words, containing all possible combination of all lowercase letters, from a to z and all digits from 0 to 9, with a minimal and maximal length of 5, for each combination.

```powershell
# Start hydra using a dictionary for list of words
python hydra.py \
    -u <username> \     # username: root
    -s <remoteserver> \ # server: 123.45.67.89
    -w dictionary.txt   # wordlist: dictionary.txt
```

This reads a list of words from dictionary.txt file.

After the list of words is set, hydra loops over all words and tries to establish connection to the server via ssh-client.
If connection is a success, the password is printed and then it runs 'whoami' command and prints the result.

### Prove of concept

```powershell
# Build the target machine
docker build \
    --build-arg PORT=2222 \
    PASSWORD=changeme \
    -t python-ssh .

# Add changeme to dictionary.txt

# Run the target machine
docker run -d \
    --name python-ssh-container \
    -p 2222:2222 \
    python-ssh

# On host machine make sure the python environment is activated and run hydra:
python hydra.py \
    -u root \
    -s localhost \
    -p 2222 \
    -w dictionary.txt

Initializing Hydra Clone...
Getting words...
Using File dictionary.txt to read words...
Got 1 Word(s)...
Starting connections to localhost as root
Please wait...
Connection 1 established! Password -> changeme
Executing command 'whoami'...
Command response: root

Closing SSH Client...
Hydra Exited!

# If you do not see the output above,
# make sure that dictionary.txt contains the word changeme.

# Try binding to different ports:
# Stop and remove container
docker stop python-ssh-container
docker rm python-ssh-container

# Start container again but with different port binding:
docker run -d \
    --name python-ssh-container \
    -p 8888:2222 \
    python-ssh

# Run hydra again:
python hydra.py \
    -u root \
    -s localhost \
    -p 8888 \
    -w dictionary.txt
```
