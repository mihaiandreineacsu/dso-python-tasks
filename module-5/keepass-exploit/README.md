# My `keepass-exploit` tool

This is my automation tool to exploit [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/cve-2023-32784).

This implementation covers the following features/options:

- Collects `.DMP` and `.kdbx` files from a given directory.
- Extracts all possible passwords from `.DMP` files using [keepass-dump-masterkey](https://github.com/mihaiandreineacsu/keepass-dump-masterkey).
- Generates all possible passwords for all `.kdbx` files.
- Brute forces `.kdbx` files using [pykeepass](https://pypi.org/project/pykeepass/).
- Generates `.pot` files for each successfully brute-forced `.kdbx` in the given directory.

## Table of content

- [Technologies](#technologies)
- [Dependencies](#dependencies)
- [Command-line arguments](#command-line-arguments)
- [Structure](#structure)
- [Getting Started](#getting-started)
- [Installation](#installation)
- [Usage Example](#usage-example)

## Technologies

- Windows 11
- Python 3.10.11
- `venv` (python virtual environment)

## Dependencies

- `exrex==0.11.0`: Used to generate all possible combinations of passwords from [keepass-dump-masterkey](https://github.com/mihaiandreineacsu/keepass-dump-masterkey) results.
- `pykeepass==4.1.0.post1`: Used to brute force `.kdbx` files using generated passwords.

## Command-line arguments

| Name | Description | Default | Type | Mandatory |
| :--- | :--- | :---: | :---: | :---: |
| `--dir` | Location directory of `.kdbx` and `.DMP` files. | | str | x |
| `--debug` | Enable debug-level logging (flag, no value required) | | bool | |

## Structure

- [init.py](./app/init.py): Initializes the command-line arguments.
- [logger.py](./app/logger.py): Contains logging functions used to log messages.
- [keepass-exploit.py](./keepass-exploit.py): Main file to run and pass command-line arguments.
- [keepass-dump-masterkey](./keepass-dump-masterkey/): Git submodule to collect possible passwords from `.DMP` files.
- [utils.py](./utils.py): Helper functions to handle the passed command-line arguments.

## Getting Started

### Installation

```powershell
# Create and activate the Python virtual environment
python -m venv venv
./venv/Scripts/activate

# Install dependencies
pip install -r requirements.txt
```

### Usage Example

```powershell
# Create and activate the Python virtual environment
python keepass-exploit.py `
    --dir <input-directory>  # Directory containing .kdbx and .DMP files.
    --debug                  # Optional: Enables debug logs.
```
