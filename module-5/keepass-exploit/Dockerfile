# Use an official .NET SDK image as the base
FROM mcr.microsoft.com/dotnet/sdk:7.0 AS build-env

# Set the working directory
WORKDIR /app

# Copy your project files into the container
COPY ./app /app

COPY requirements.txt /tmp/requirements.txt

# Install Python, Hashcat, and necessary dependencies, then clean up
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    python3 \
    python3-pip \
    && pip3 install -r /tmp/requirements.txt \
    && apt-get clean && \
    rm -rf /var/lib/apt/lists/* /tmp/*

# Set Python 3 as the default Python version
RUN update-alternatives --install /usr/bin/python python /usr/bin/python3 1

# Set the environment variable globally
ENV HASHCAT_PATH=/app

# Set the default command to bash
CMD ["/bin/bash"]
