"""
This script is intended solely for educational purposes as an exercise in imitation.
Any practical use of this script outside of educational or supervised demonstration scenarios is strictly prohibited.

Author: Mihai-Andrei Neacsu
"""

import argparse
import os
from logger import init_logger, log_msg


def init() -> argparse.Namespace:
    """
    Initializes Command-line arguments.

    Accepted arguments:
        --dir: (str)
        --debug: (bool)

    Usage examples: TBD
    """
    log_msg("Initializing keepass exploit...")
    parser = argparse.ArgumentParser(description="Exploit CVE-2023-32784 script")
    parser.add_argument("--dir", required=True, type=str, help="Location directory of .kdbx- and .DMP files pair.")
    parser.add_argument("--debug", action="store_true", help="Prints debug logs.")
    args = parser.parse_args()

    # Validate the directory
    if not os.path.isdir(args.dir):
        raise ValueError(f"The directory '{args.dir}' does not exist.")
    args.dir = os.path.abspath(args.dir)
    # Check if directory contains any files
    # if not any(os.path.isfile(os.path.join(args.dir, f)) for f in os.listdir(args.dir)):
    #     raise ValueError(f"The directory '{args.dir}' is empty or contains no files.")

    init_logger(args)
    return args
